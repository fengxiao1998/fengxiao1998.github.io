import{_ as G,o as J,r as c,d as p,e as m,c as K,a as s,f as o,w as n,g as d,V as k,h as Q,b as j,t as i,i as h,j as R,k as W}from"./index-OfiJFNpZ.js";import{g as V}from"./request-BL2JyA8f.js";const X={class:"home"},Z={class:"main"},ee={class:"main_userinfo"},se={class:"main_content"},te={class:"main_content"},ae={class:"main_content"},oe={class:"main_market"},ne={class:"main_content"},le={class:"main_content"},re={class:"main_handle"},ie={class:"main_data"},ce={class:"main_data-tab"},de={class:"main_data-tab"},ue={class:"home_input"},_e={class:"home_input"},pe={class:"home_btn"},me={__name:"HomeView",setup(he){J(()=>{w()});const w=()=>{T(),M(),E()},x=()=>{localStorage.clear("loginInfo"),k.Message.info("退出成功"),Q.push({path:"/login"})},v=c({cash:1e6,portfolio_value:11e6,shares:5e3}),T=async()=>{try{const t=await V("/participant");Object.assign(v,t)}catch(t){console.log("测试错误",t)}},f=c({arket_status:"open",price:2e3,timestamp:"2025-06-16T17:09:52.446693+08:00"}),P=c([{title:"买家挂单价格",key:"buy_orders_price"},{title:"买家挂单量",key:"buy_orders_shares"}]),U=c([{title:"卖家挂单价格",key:"sell_orders_price"},{title:"卖家挂单量",key:"sell_orders_shares"}]),C=c([]),I=c([]),y=p(!1),A=m(()=>f.arket_status=="open"?"开放":"关闭"),M=async()=>{try{const t=await V("/price");Object.assign(f,t)}catch(t){console.log("测试错误",t)}},E=async()=>{try{const t=await V("/orderbook"),e=t.buy_orders.forEach(a=>{a.buy_orders_price=a.price,a.buy_orders_shares=a.shares}),g=t.buy_orders.forEach(a=>{a.sell_orders_price=a.price,a.sell_orders_shares=a.shares});Object.assign(C,e),Object.assign(I,g)}catch(t){console.log("测试错误",t)}},H=m(()=>l.value=="buy"?"请输入买入价格":"请输入卖出价格"),$=m(()=>l.value=="buy"?"请输入买入份额":"请输入卖出份额"),D=m(()=>l.value=="buy"?"买入价格":"卖出价格"),L=m(()=>l.value=="buy"?"买入份额":"卖出份额"),u=p(!1),l=p("buy"),b=p(0),_=p(100),S=t=>{l.value=t,u.value=!0},B=()=>{u.value=!1,b.value=1,_.value=100,y.value=!1},Y=()=>{if(_.value<100)return y.value=!0,!1;y.value=!1,q()},q=async()=>{try{if(await M(),f.arket_status!=="open"){k.Notice.open({title:"提示",desc:"交易时间已过！市场已经关闭！"}),B();return}const t=l.value=="buy"?"/buy":"/sell",e={order_type:l.value,price:b.value.toString(),shares:_.value.toString()};await V(t,e),k.Notice.open({title:"提示",desc:"操作成功！"}),u.value=!1,w()}catch(t){console.log(t),k.Notice.open({title:"提示",desc:"由于后端原因，操作失败！"})}};return(t,e)=>{const g=d("Card"),a=d("Button"),N=d("Table"),O=d("Input"),z=d("Alert"),F=d("Modal");return j(),K("div",X,[s("header",{class:"header"},[e[5]||(e[5]=s("div",{class:"header_info"},[s("img",{class:"header_info-img",src:"https://pic.imagurl.cn/imagurl/2025/06/17/6850d3886b0f3.jpg"}),s("span",{class:"header_info-name"},"韭菜")],-1)),e[6]||(e[6]=s("span",{class:"header_title"},"全忽悠A股上市系统",-1)),s("span",{class:"header_info-loginout",onClick:x},"退出登录")]),s("main",Z,[s("div",ee,[o(g,{shadow:""},{title:n(()=>e[7]||(e[7]=[s("h4",{class:"main_userinfo-info"},"当前用户信息",-1)])),default:n(()=>[s("p",se,"账户余额："+i(v.cash),1),s("p",te,"市值："+i(v.portfolio_value),1),s("p",ae,"股份："+i(v.shares),1)]),_:1}),s("div",oe,[o(g,{shadow:""},{title:n(()=>e[8]||(e[8]=[s("h4",{class:"main_userinfo-info"},"当前市场信息",-1)])),default:n(()=>[s("p",ne,"当前市场开放状态："+i(A.value),1),s("p",le,"当前市场市值："+i(f.price),1),s("div",re,[o(a,{class:"main_handle-btn",type:"primary",onClick:e[0]||(e[0]=r=>S("buy"))},{default:n(()=>e[9]||(e[9]=[h(" 买入 ")])),_:1,__:[9]}),o(a,{class:"main_handle-btn",type:"error",onClick:e[1]||(e[1]=r=>S("sell"))},{default:n(()=>e[10]||(e[10]=[h(" 卖出 ")])),_:1,__:[10]})])]),_:1})]),s("div",ie,[s("div",ce,[o(N,{columns:P,data:C},null,8,["columns","data"])]),s("div",de,[o(N,{columns:U,data:I},null,8,["columns","data"])])])])]),o(F,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=r=>u.value=r),title:"投资有风险,买卖需谨慎","footer-hide":""},{default:n(()=>[s("div",ue,[s("span",null,i(D.value),1),o(O,{class:"home_input",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=r=>b.value=r),placeholder:H.value,type:"number"},null,8,["modelValue","placeholder"])]),s("div",_e,[s("span",null,i(L.value),1),o(O,{class:"home_input",modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=r=>_.value=r),placeholder:$.value,type:"number"},null,8,["modelValue","placeholder"])]),y.value?(j(),R(z,{key:0,type:"error"},{default:n(()=>e[11]||(e[11]=[h("份额最小为100！")])),_:1,__:[11]})):W("",!0),s("div",pe,[o(a,{class:"home_handle-btn",type:"error",onClick:B},{default:n(()=>e[12]||(e[12]=[h("取消")])),_:1,__:[12]}),o(a,{class:"home_handle-btn",type:"primary",onClick:Y},{default:n(()=>e[13]||(e[13]=[h("确认")])),_:1,__:[13]})])]),_:1},8,["modelValue"])])}}},ye=G(me,[["__scopeId","data-v-b012746a"]]);export{ye as default};
